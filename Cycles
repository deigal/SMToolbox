--Set cycle boundaries
--Apply Expression
{
  "program": [
    "copyInputRecord()",
    "epoch = DateTime.unixEpoch()",
    "ms = duration(epoch, getInput('timestamp'))",
    "counter = ms - (ms % 30000)",
    "setOutput('counter', counter)"
  ]
}

--Lookahead
{
  "partition_by": [
    "machine"
  ],
  "fields": [
    {
      "from_field": "counter",
      "to_field": "next_counter"
    }
  ]
}
